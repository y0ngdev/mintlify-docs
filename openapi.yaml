components:
  securitySchemes:
    rootKey:
      bearerFormat: root key
      description: |-
        Locket employs API keys (root keys) for authentication. These keys grant access to management operations.
        To authenticate, include your root key in the Authorization header:
        ```
        Authorization: Bearer locket_123
        ```
        Root keys have specific permissions that control which operations they can perform, often following a pattern like `resource.id.action`.
        Security best practices:
        - Secure root keys and never expose them client-side.
        - Utilize separate keys for different environments.
        - Rotate keys periodically.
        - Adhere to the principle of least privilege.
        - Monitor key activity via audit logs.
      scheme: bearer
      type: http
  schemas:
    BadRequestErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BadRequestErrorDetails"
      description: Error for invalid requests that cannot be processed due to client-side issues (e.g., missing parameters, validation failures). The response details the specific errors.
    InternalServerErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error response when an unexpected server-side error occurs, indicating a problem with Locket's systems.
        When you encounter this error:
        - The request ID can help support investigate the issue.
        - The error may be temporary; retrying could succeed.
        - If it persists, contact support with the request ID.
    UnauthorizedErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error response when authentication fails or is missing. This occurs if:
        - No token is provided.
        - The token is invalid, expired, or malformed.
        To resolve, ensure a valid root key is in the Authorization header.
    ForbiddenErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error response when credentials are valid but lack permissions for the operation. This occurs if:
        - The root key doesn't have the required permissions.
        - The operation requires elevated privileges.
        To resolve, ensure your root key has the necessary permissions.
    NotFoundErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error response when the requested resource cannot be found. This occurs if:
        - The specified resource ID doesn't exist.
        - The resource has been deleted.
        To resolve, verify the resource ID is correct.
    V2ApisCreateApiRequestBody:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z][a-zA-Z0-9._-]*$"
          description: |
            A unique identifier for this API namespace within the workspace.
            Use descriptive names (e.g., 'payment-service-prod') to identify its purpose.
          example: payment-service-production
      additionalProperties: false
    V2ApisCreateApiResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        data:
          $ref: "#/components/schemas/V2ApisCreateApiResponseData"
      additionalProperties: false
    V2ApisDeleteApiRequestBody:
      type: object
      required:
        - apiId
      properties:
        apiId:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            Specifies the API namespace to delete permanently.
            Must be a valid API ID (starting with 'api_'). This action cannot be undone.
          example: api_1234abcd
      additionalProperties: false
    V2ApisDeleteApiResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        data:
          $ref: "#/components/schemas/EmptyResponse"
      additionalProperties: false
    PreconditionFailedErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error when conditions in request headers (like If-Match) are not met, often due to optimistic concurrency control conflicts.
        To resolve, fetch the latest resource version and retry.
    V2ApisGetApiRequestBody:
      type: object
      required:
        - apiId
      properties:
        apiId:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            Specifies the API to retrieve by its unique identifier.
            Must be a valid API ID (starting with 'api_').
          example: api_1234abcd
      additionalProperties: false
    V2ApisGetApiResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2ApisGetApiResponseData"
      additionalProperties: false
    V2ApisListKeysRequestBody:
      type: object
      required:
        - apiId
      properties:
        apiId:
          type: string
          minLength: 1
          description: |
            The API namespace whose keys you want to list.
          example: api_1234abcd
        limit:
          type: integer
          description: |
            Maximum number of keys to return (1-100).
          default: 100
          minimum: 1
          maximum: 100
        cursor:
          type: string
          description: |
            Pagination cursor from a previous response to fetch the next page.
          example: key_1234abcd
        externalId:
          type: string
          minLength: 3
          description: |
            Filter keys by the external ID (e.g., your user ID) set during key creation.
          example: user_1234abcd
        decrypt:
          type: boolean
          description: |-
            SECURITY WARNING: If true, attempts to return the plaintext key.
            - Requires special permissions.
            - Only works for keys created as 'recoverable'.
            - Exposes sensitive key material. Use only in secure admin contexts.
          default: false
        revalidateKeysCache:
          type: boolean
          default: false
          description: |-
            EXPERIMENTAL: Skips the cache to fetch keys directly from the database for most recent state.
            This has a performance cost and should be used sparingly.
      additionalProperties: false
    V2ApisListKeysResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2ApisListKeysResponseData"
        pagination:
          "$ref": "#/components/schemas/Pagination"
      additionalProperties: false
    V2IdentitiesCreateIdentityRequestBody:
      type: object
      required:
        - externalId
      properties:
        externalId:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z0-9_.-]+$"
          description: |
            Creates an identity using your system's unique identifier for an entity.
            Must be stable and unique. This links Locket identities to your auth system.
            Essential for multi-tenancy and user-specific rate limiting.
          example: user_123
        meta:
          type: object
          additionalProperties: true
          maxProperties: 100
          description: |
            Arbitrary JSON metadata to store contextual information.
            Returned during key verification, improving performance by avoiding extra lookups.
            Avoid storing sensitive data. Keep under 10KB.
        ratelimits:
          type: array
          maxItems: 50
          items:
            "$ref": "#/components/schemas/RatelimitRequest"
          description: |
            Defines shared rate limits that apply to all keys belonging to this identity.
            Prevents abuse by enforcing consistent limits across an entity's entire key portfolio.
    V2IdentitiesCreateIdentityResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2IdentitiesCreateIdentityResponseData"
    ConflictErrorResponse:
      type: object
      required:
        - meta
        - error
      properties:
        meta:
          $ref: "#/components/schemas/Meta"
        error:
          $ref: "#/components/schemas/BaseError"
      description: |-
        Error when the request conflicts with the current state of a resource (e.g., creating a resource that already exists).
        Check the resource's current state and adjust the request.
    V2IdentitiesDeleteIdentityRequestBody:
      type: object
      properties:
        identity:
          type: string
          minLength: 3
          description: The ID of the identity to delete. Can be the externalId (your ID) or the identityId (internal ID).
          example: user_123
      additionalProperties: false
      required:
        - identity
    V2IdentitiesDeleteIdentityResponseBody:
      type: object
      description: An empty response indicates the identity was deleted successfully.
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
      required:
        - meta
    V2IdentitiesGetIdentityRequestBody:
      type: object
      properties:
        identity:
          type: string
          minLength: 3
          description: The ID of the identity to retrieve. Can be the externalId (your ID) or the identityId (internal ID).
          example: user_abc123
      additionalProperties: false
      required:
        - identity
    V2IdentitiesGetIdentityResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/Identity"
    V2IdentitiesListIdentitiesRequestBody:
      type: object
      properties:
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 100
          description: The maximum number of identities to return (1-100).
          example: 50
        cursor:
          type: string
          description: Pagination cursor from a previous response to fetch the next page.
          example: cursor_eyJrZXkiOiJrZXlfMTIzNCJ9
      additionalProperties: false
    V2IdentitiesListIdentitiesResponseBody:
      type: object
      required:
        - meta
        - data
        - pagination
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2IdentitiesListIdentitiesResponseData"
        pagination:
          "$ref": "#/components/schemas/Pagination"
      additionalProperties: false
    V2IdentitiesUpdateIdentityRequestBody:
      type: object
      properties:
        identity:
          type: string
          minLength: 3
          description: The ID of the identity to update. Can be the externalId (your ID) or the identityId (internal ID).
          example: user_123
        meta:
          type: object
          additionalProperties: true
          maxProperties: 100
          description: |
            Replaces all existing metadata with this new object.
            Omitting this field preserves existing metadata.
            Providing an empty object clears all metadata. Keep under 10KB.
          example:
            name: Alice Smith
            email: alice@example.com
            plan: premium
        ratelimits:
          type: array
          maxItems: 50
          items:
            $ref: "#/components/schemas/RatelimitRequest"
          description: |
            Replaces all existing identity rate limits with this new list.
            Omitting this field preserves existing rate limits.
            Providing an empty array removes all rate limits.
          example:
            - name: requests
              limit: 1000
              duration: 3600000
              autoApply: true
      additionalProperties: false
      required:
        - identity
    V2IdentitiesUpdateIdentityResponseBody:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          "$ref": "#/components/schemas/Identity"
        meta:
          "$ref": "#/components/schemas/Meta"
    V2PermissionsCreatePermissionRequestBody:
      type: object
      required:
        - name
        - slug
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 512
          description: |
            A human-readable, unique name for the permission.
            Use clear names (e.g., 'users.read', 'billing.write').
          example: "users.read"
        slug:
          type: string
          minLength: 1
          maxLength: 128
          pattern: "^[a-zA-Z][a-zA-Z0-9._-]*$"
          description: |
            A URL-safe, unique identifier for the permission used in APIs.
            Should closely match the name.
          example: "users-read"
        description:
          type: string
          maxLength: 128
          description: |
            Optional. Detailed documentation of what this permission grants.
            For internal use by development teams.
          example: "Grants read-only access to user profile information."
      additionalProperties: false
    V2PermissionsCreatePermissionResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2PermissionsCreatePermissionResponseData"
      additionalProperties: false
    V2PermissionsCreateRoleRequestBody:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 512
          pattern: "^[a-zA-Z][a-zA-Z0-9._-]*$"
          description: |
            The unique name for this role (e.g., 'admin', 'editor').
          example: "support.readonly"
        description:
          type: string
          maxLength: 2048
          description: |
            Optional. Comprehensive documentation of the role's purpose and scope.
            For internal use by administration teams.
          example: "Provides read-only access for customer support representatives."
      additionalProperties: false
    V2PermissionsCreateRoleResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2PermissionsCreateRoleResponseData"
      additionalProperties: false
    V2PermissionsDeletePermissionRequestBody:
      type: object
      required:
        - permission
      properties:
        permission:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z][a-zA-Z0-9._-]*$"
          description: |
            Specifies the permission to delete permanently, by ID or slug.
            WARNING: This is irreversible and removes the permission from all keys and roles immediately.
          example: perm_1234567890abcdef
      additionalProperties: false
    V2PermissionsDeletePermissionResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/EmptyResponse"
      additionalProperties: false
    V2PermissionsDeleteRoleRequestBody:
      type: object
      required:
        - role
      properties:
        role:
          type: string
          pattern: ^[a-zA-Z0-9_:\-\.\*]+$
          minLength: 3
          maxLength: 255
          description: |
            Unique identifier of the role to delete permanently, by ID or name.
            WARNING: This is irreversible and removes the role from all keys immediately.
          example: role_dns_manager
      additionalProperties: false
    V2PermissionsDeleteRoleResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/EmptyResponse"
      additionalProperties: false
    V2PermissionsGetPermissionRequestBody:
      type: object
      required:
        - permission
      properties:
        permission:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z][a-zA-Z0-9._-]*$"
          description: |
            The unique identifier (ID or slug) of the permission to retrieve.
          example: perm_1234567890abcdef
      additionalProperties: false
    V2PermissionsGetPermissionResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/Permission"
      additionalProperties: false
    V2PermissionsGetRoleRequestBody:
      type: object
      required:
        - role
      properties:
        role:
          type: string
          minLength: 3
          maxLength: 255
          pattern: ^[a-zA-Z0-9_:\-\.\*]+$
          description: |
            Unique identifier (ID or name) of the role to retrieve.
            Returns the role's details and all assigned permissions.
          example: role_1234567890abcdef
      additionalProperties: false
    V2PermissionsGetRoleResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/Role"
      additionalProperties: false
    V2PermissionsListPermissionsRequestBody:
      type: object
      properties:
        cursor:
          type: string
          maxLength: 1024
          description: |
            Pagination cursor from a previous response to fetch the next page.
            Omit this field to start from the beginning.
          example: "eyJrZXkiOiJwZXJtXzEyMzQifQ=="
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 100
          description: Maximum number of permissions to return (1-100).
          example: 50
      additionalProperties: false
    V2PermissionsListPermissionsResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2PermissionsListPermissionsResponseData"
        pagination:
          "$ref": "#/components/schemas/Pagination"
      additionalProperties: false
    V2PermissionsListRolesRequestBody:
      type: object
      properties:
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 100
          description: |
            Maximum number of roles to return (1-100).
          example: 50
        cursor:
          type: string
          maxLength: 1024
          description: |
            Pagination cursor from a previous response to fetch the next page.
            Omit this field to start from the beginning.
          example: "eyJrZXkiOiJyb2xlXzEyMzQifQ=="
      additionalProperties: false
    V2PermissionsListRolesResponseBody:
      type: object
      required:
        - meta
        - data
      properties:
        meta:
          "$ref": "#/components/schemas/Meta"
        data:
          "$ref": "#/components/schemas/V2PermissionsListRolesResponseData"
        pagination:
          "$ref": "#/components/schemas/Pagination"
      additionalProperties: false
    Meta:
      type: object
      required:
        - requestId
      properties:
        requestId:
          description: A unique identifier for the request. Include this ID when contacting support, as it allows the Locket support team to trace the request.
          example: req_123
          type: string
      additionalProperties: false
      description: Metadata included in every API response, essential for debugging and support.
    BadRequestErrorDetails:
      allOf:
        - $ref: "#/components/schemas/BaseError"
        - type: object
          properties:
            errors:
              description: A list of individual validation errors, providing specific details on what failed and where.
              items:
                $ref: "#/components/schemas/ValidationError"
              type: array
          required:
            - errors
      description: Extended error details for bad request (400) errors, including specific validation failures.
    BaseError:
      properties:
        detail:
          description: A human-readable explanation of the specific error occurrence.
          example: Property foo is required but is missing.
          type: string
        status:
          description: HTTP status code corresponding to this error (e.g., 400, 404, 500).
          example: 404
          format: int
          type: integer
        title:
          description: A short, human-readable summary of the problem type.
          example: Not Found
          type: string
        type:
          description: A URI reference that identifies the problem type, linking to error documentation.
          example: https://locket.com/docs/errors/locket/resource/not_found
          type: string
      required:
        - title
        - detail
        - status
        - type
      type: object
      additionalProperties: false
      description: Base error structure following RFC 7807 (Problem Details for HTTP APIs).
    ValidationError:
      additionalProperties: false
      properties:
        location:
          description: |-
            JSON path indicating the exact location of the error in the request (e.g., 'body.name', 'query.limit').
          type: string
          example: body.permissions[0].name
        message:
          description: Detailed message explaining the validation rule that was violated.
          type: string
          example: Must be at least 3 characters long
        fix:
          description: A human-readable suggestion on how to fix the error.
          type: string
          example: Ensure the name uses only alphanumeric characters
      required:
        - location
        - message
      type: object
      description: Details for an individual validation error.
    V2ApisCreateApiResponseData:
      type: object
      properties:
        apiId:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            The unique ID for the new API. This ID is required for any future operations related to this API.
            It is always prefixed with 'api_'.
          example: api_2cGKbMxRjIzhCxo1IdjH3a
      required:
        - apiId
      additionalProperties: false
    EmptyResponse:
      type: object
      additionalProperties: false
      description: An empty response object. A successful 200 status indicates the operation succeeded.
    V2ApisGetApiResponseData:
      type: object
      properties:
        id:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            The unique identifier for this API within the Locket system.
            Always begins with 'api_'.
          example: api_1234567890abcdef
        name:
          type: string
          minLength: 3
          maxLength: 255
          description: |
            The user-provided internal name for this API, used for identification.
            Not visible to end users.
          example: payment-service-production
      required:
        - id
        - name
      additionalProperties: false
    V2ApisListKeysResponseData:
      type: array
      maxItems: 100
      items:
        "$ref": "#/components/schemas/KeyResponseData"
      description: An array of API key objects.
    Pagination:
      type: object
      properties:
        cursor:
          type: string
          minLength: 1
          maxLength: 1024
          description: |
            An opaque pagination token for retrieving the next page of results.
          example: eyJrZXkiOiJrZXlfMTIzNCIsInRzIjoxNjk5Mzc4ODAwfQ==
        hasMore:
          type: boolean
          description: |
            True if more results are available beyond this page.
          example: true
      required:
        - hasMore
      additionalProperties: false
      description: Pagination metadata for list endpoints.
    KeyResponseData:
      type: object
      properties:
        keyId:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: Unique identifier for this key (e.g., 'key_...').
          example: key_1234567890abcdef
        start:
          type: string
          minLength: 1
          maxLength: 50
          description: The first few characters of the key (prefix) for identification.
          example: sk_test_abc123
        enabled:
          type: boolean
          description: Whether the key is currently active.
          example: true
        name:
          type: string
          maxLength: 255
          description: Human-readable name for this key.
          example: Production API Key
        meta:
          type: object
          additionalProperties: true
          maxProperties: 100
          description: Custom metadata associated with this key.
          example: {}
        createdAt:
          type: integer
          format: int64
          minimum: 0
          maximum: 9223372036854776000
          description: Unix timestamp (ms) when the key was created.
          example: 1701425400000
        updatedAt:
          type: integer
          format: int64
          minimum: 0
          maximum: 9223372036854776000
          description: Unix timestamp (ms) when the key was last updated.
          example: 1701425400000
        expires:
          type: integer
          format: int64
          minimum: 0
          maximum: 9223372036854776000
          description: Unix timestamp (ms) when the key expires (if set).
          example: 1735689600000
        permissions:
          type: array
          items:
            type: string
            description: List of permission slugs granted directly to this key.
          example:
            - documents.read
            - documents.write
        roles:
          type: array
          items:
            type: string
            description: List of role names assigned to this key.
          example:
            - editor
            - viewer
        identity:
          "$ref": "#/components/schemas/Identity"
        plaintext:
          type: string
          description: The decrypted key value (only present if 'decrypt=true' was requested).
          example: sk_test_abc123def456
        ratelimits:
          type: array
          maxItems: 50
          items:
            "$ref": "#/components/schemas/RatelimitResponse"
        keyCredits:
          "$ref": "#/components/schemas/KeyCreditsData"
      required:
        - keyId
        - start
        - createdAt
        - enabled
      additionalProperties: false
    KeyCreditsData:
      type: object
      description: Credit configuration and remaining balance for this key.
      properties:
        remaining:
          type:
            - integer
            - "null"
          format: int64
          minimum: 0
          maximum: 9223372036854776000
          description: Number of credits remaining (null for unlimited).
          example: 1000
        refill:
          "$ref": "#/components/schemas/KeyCreditsRefill"
      required:
        - remaining
      additionalProperties: false
    Identity:
      type: object
      properties:
        id:
          type: string
          description: The internal unique ID of the identity.
        externalId:
          type: string
          description: The external identifier (from your system) for the identity.
        meta:
          type: object
          additionalProperties: true
          description: Custom metadata associated with the identity.
        ratelimits:
          type: array
          description: List of rate limit configurations for the identity.
          items:
            "$ref": "#/components/schemas/RatelimitResponse"
      required:
        - externalId
        - id
    RatelimitResponse:
      type: object
      properties:
        id:
          type: string
          minLength: 8
          maxLength: 255
          pattern: "^rl_[a-zA-Z0-9_]+$"
          description: Unique identifier for this rate limit configuration.
          example: rl_1234567890abcdef
        name:
          type: string
          minLength: 1
          maxLength: 128
          description: Human-readable name for this rate limit.
          example: api_requests
        limit:
          type: integer
          format: int64
          minimum: 1
          maximum: 1000000
          description: Maximum requests allowed in the window.
          example: 1000
        duration:
          type: integer
          format: int64
          minimum: 1000
          maximum: 2592000000
          description: The duration of the window in milliseconds.
          example: 3600000
        autoApply:
          type: boolean
          description: Whether this rate limit was automatically applied during verification.
          example: true
      required:
        - id
        - name
        - limit
        - duration
        - autoApply
      additionalProperties: false
    KeyCreditsRefill:
      type: object
      description: Configuration for automatic credit refills.
      properties:
        interval:
          type: string
          enum:
            - daily
            - monthly
          description: Frequency of automatic refills.
          example: daily
        amount:
          type: integer
          format: int64
          minimum: 1
          maximum: 9223372036854776000
          description: Number of credits to add each cycle.
          example: 1000
        refillDay:
          type: integer
          minimum: 1
          maximum: 31
          description: |
            Day of the month for 'monthly' refills (1-31).
          example: 15
      required:
        - interval
        - amount
      additionalProperties: false
    RatelimitRequest:
      type: object
      required:
        - name
        - limit
        - duration
        - autoApply
      properties:
        name:
          description: |-
            The name of this rate limit, used for identification during verification.
            Use descriptive names (e.g., 'api_requests', 'heavy_operations').
          type: string
          example: api
          minLength: 3
          maxLength: 128
        limit:
          description: |-
            The maximum number of operations allowed within the window.
            When reached, verification fails with `code=RATE_LIMITED`.
          type: integer
          format: int64
          minimum: 1
        duration:
          description: |-
            The duration of the rate limit window in milliseconds.
            Common values: 60000 (1 min), 3600000 (1 hr), 86400000 (24 hr).
          type: integer
          format: int64
          minimum: 1000
        autoApply:
          description: Whether this rate limit should be automatically checked during verification.
          type: boolean
          default: false
    V2IdentitiesCreateIdentityResponseData:
      type: object
      properties:
        identityId:
          type: string
          description: The unique identifier of the created identity.
      required:
        - identityId
    V2IdentitiesListIdentitiesResponseData:
      type: array
      items:
        "$ref": "#/components/schemas/Identity"
      description: A list of identity objects.
    Permission:
      type: object
      properties:
        id:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            The internal unique identifier for this permission (e.g., 'perm_...').
          example: perm_1234567890abcdef
        name:
          type: string
          minLength: 1
          maxLength: 512
          description: |
            The human-readable, unique name for this permission.
          example: "users.read"
        slug:
          pattern: ^[a-zA-Z0-9_:\-\.\*]+$
          type: string
          minLength: 1
          maxLength: 512
          description: The unique URL-safe identifier (slug) for this permission.
          example: users-read
        description:
          type: string
          maxLength: 2048
          description: |
            Optional. A detailed explanation of what this permission grants.
          example: "Allows reading user profile information"
      required:
        - id
        - name
        - slug
    Role:
      type: object
      properties:
        id:
          type: string
          description: |
            The internal unique identifier for this role (e.g., 'role_...').
          example: role_1234567890abcdef
        name:
          type: string
          description: |
            The human-readable, unique name for this role.
          example: "support.readonly"
        description:
          type: string
          description: |
            Optional. A detailed explanation of the role's purpose and scope.
          example: "Provides read-only access for customer support"
        permissions:
          type: array
          items:
            "$ref": "#/components/schemas/Permission"
          maxItems: 100
          description: |
            A list of permissions currently assigned to this role.
      required:
        - id
        - name
      additionalProperties: false
    V2PermissionsCreatePermissionResponseData:
      type: object
      properties:
        permissionId:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            The unique identifier (e.g., 'perm_...') assigned to the newly created permission.
          example: perm_1234567890abcdef
      required:
        - permissionId
      additionalProperties: false
    V2PermissionsCreateRoleResponseData:
      type: object
      properties:
        roleId:
          type: string
          minLength: 3
          maxLength: 255
          pattern: "^[a-zA-Z0-9_]+$"
          description: |
            The unique identifier (e.g., 'role_...') assigned to the newly created role.
          example: role_1234567890abcdef
      required:
        - roleId
      additionalProperties: false
    V2PermissionsListPermissionsResponseData:
      type: array
      maxItems: 1000
      description: An array of permission objects.
      items:
        "$ref": "#/components/schemas/Permission"
    V2PermissionsListRolesResponseData:
      type: array
      maxItems: 1000
      description: An array of role objects, including their assigned permissions.
      items:
        "$ref": "#/components/schemas/Role"
info:
  description: |-
    The Locket API offers programmatic management for all resources on the platform.

    ### Authentication
    #
    Authentication is handled via HTTP Bearer tokens (root keys). Most endpoints require specific permissions associated with your root key. Include your key in the `Authorization` header:
    ```
    Authorization: Bearer locket_xxxxxxxxxxx
    ```

    All API responses use a standardized envelope format for consistency, easier debugging, and better error handling.

    ### Success Response Format:
    ```json
    {
      "meta": {
        "requestId": "req_123456"
      },
      "data": {
        // Actual response data here
      }
    }
    ```

    The `meta` object contains operational information:
    - `requestId`: Unique identifier for this request (essential for support).

    The `data` object contains the endpoint-specific response data.

    ### Paginated Response Format:
    ```json
    {
      "meta": {
        "requestId": "req_123456"
      },
      "data": [
        // Array of results
      ],
      "pagination": {
        "cursor": "next_page_token",
        "hasMore": true
      }
    }
    ```

    The `pagination` object appears on list endpoints:
    - `cursor`: Token for requesting the next page.
    - `hasMore`: Whether more results are available.

    ### Error Response Format:
    ```json
    {
      "meta": {
        "requestId": "req_2c9a0jf23l4k567"
      },
      "error": {
        "detail": "The resource you are attempting to modify is protected.",
        "status": 403,
        "title": "Forbidden",
        "type": "[https://locket.com/docs/errors/locket/application/protected_resource](https://locket.com/docs/errors/locket/application/protected_resource)"
      }
    }
    ```

    Error responses include diagnostic information:
    - `title`: Summary of the error.
    - `detail`: Specific description of the error.
    - `status`: HTTP status code.
    - `type`: Link to error documentation.
    - `errors`: Array of validation errors (for 400 responses).
  title: Locket API
  version: 2.0.0
openapi: 3.1.0
paths:
  /apis/create:
    post:
      description: |
        Establishes a new API namespace, which serves as a container for organizing keys.
        This is useful for separating environments (e.g., production, development) or services.

        **Note**: API names are required to be unique within a workspace and cannot be changed after creation.

        **Permissions Needed**: Requires `api.*.create_api` permission.
      operationId: createApi
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2ApisCreateApiRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2ApisCreateApiResponseBody'
          description: |
            API namespace created successfully. The response contains the unique API ID.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Create an API Namespace
      tags:
        - apis
      x-speakeasy-name-override: createApi
  /apis/delete:
    post:
      description: |
        Permanently deletes an API namespace and invalidates all associated keys.
        This is used for cleaning up environments or retiring services.
        All keys in the namespace will immediately fail verification.

        **Important**: This operation is permanent.

        **Permissions Needed**: Requires `api.*.delete_api` or `api.<api_id>.delete_api`.
      operationId: deleteApi
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2ApisDeleteApiRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2ApisDeleteApiResponseBody'
          description: API namespace deleted successfully. All associated keys are invalidated.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "412":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PreconditionFailedErrorResponse'
          description: Delete protection is enabled.
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Delete an API Namespace
      tags:
        - apis
      x-speakeasy-name-override: deleteApi
  /apis/get:
    post:
      description: |
        Retrieves basic information about an API namespace (ID and name).
        Use this to verify an API's existence or confirm access.

        **Permissions Needed**: Requires `api.*.read_api` or `api.<api_id>.read_api`.
      operationId: getApi
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2ApisGetApiRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2ApisGetApiResponseBody'
          description: API information retrieved successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Get an API Namespace
      tags:
        - apis
      x-speakeasy-name-override: getApi
  /apis.list/:
    post:
      description: |
        Retrieves a paginated list of API keys within a specific API namespace.
        Used for key management dashboards and administrative tasks.
        Can filter by `externalId`.

        **Important**: Setting `decrypt: true` is a security risk and requires special permissions.

        **Permissions Needed**:
        - `api.*.read_key` or `api.<api_id>.read_key`
        - And `api.*.read_api` or `api.<api_id>.read_api`
        - Decrypting requires `api.*.decrypt_key` or `api.<api_id>.decrypt_key`
      operationId: listKeys
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2ApisListKeysRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2ApisListKeysResponseBody'
          description: |
            Successfully retrieved paginated keys.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: List API Keys in a Namespace
      tags:
        - apis
      x-speakeasy-name-override: listKeys
  /identities/create:
    post:
      description: |
        Creates an identity to group multiple API keys under a single entity (like a user or organization).
        This allows for shared rate limits and metadata across all associated keys.

        **Permissions Needed**: Requires `identity.*.create_identity`.
      operationId: identities.createIdentity
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2IdentitiesCreateIdentityRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2IdentitiesCreateIdentityResponseBody'
          description: Identity created successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden - Insufficient permissions
        "409":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictErrorResponse'
          description: Conflict - Identity with this externalId already exists
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Create an Identity
      tags:
        - identities
      x-speakeasy-name-override: createIdentity
  /identities/delete:
    post:
      description: |
        Permanently deletes an identity. This action cannot be undone.
        Used for data cleanup or compliance.

        **Note**:
        - Requires `identity.*.delete_identity` permission.
        - Associated API keys remain functional but lose shared resources.
      operationId: v2.identities.deleteIdentity
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2IdentitiesDeleteIdentityRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2IdentitiesDeleteIdentityResponseBody'
          description: Identity successfully deleted.
        "400":
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden - Insufficient permissions
        "404":
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found - Identity doesn't exist
        "500":
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Error
      security:
        - rootKey: []
      summary: Delete an Identity
      tags:
        - identities
      x-speakeasy-name-override: deleteIdentity
  /identities/get:
    post:
      description: |
        Retrieves an identity by its external ID or internal ID.
        Returns metadata, rate limits, and other associated data.

        **Note**: Requires `identity.*.read_identity` permission.
      operationId: identities.getIdentity
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2IdentitiesGetIdentityRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2IdentitiesGetIdentityResponseBody'
          description: Successfully retrieved the identity information.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden - Insufficient permissions
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found - Identity doesn't exist
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Get an Identity
      tags:
        - identities
      x-speakeasy-name-override: getIdentity
  /identities/list:
    post:
      description: |
        Gets a paginated list of all identities in the workspace.
        Useful for management dashboards and auditing.

        **Note**: Requires `identity.*.read_identity` permission.
      operationId: identities.listIdentities
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2IdentitiesListIdentitiesRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2IdentitiesListIdentitiesResponseBody'
          description: Successfully retrieved the list of identities.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request - Invalid parameters
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized - Missing or invalid authentication
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden - Insufficient permissions
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: List Identities
      tags:
        - identities
      x-speakeasy-name-override: listIdentities
  /identities/update:
    post:
      description: |
        Updates an identity's metadata and/or rate limits.
        Only specified fields are modified; others remain unchanged.
        Useful for subscription changes, plan upgrades, or updating user info.

        **Note**:
        - Requires `identity.*.update_identity` permission.
        - Rate limit changes propagate within 30 seconds.
      operationId: v2.identities.updateIdentity
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2IdentitiesUpdateIdentityRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2IdentitiesUpdateIdentityResponseBody'
          description: Identity successfully updated.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden - Insufficient permissions
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found - Identity doesn't exist
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal server error
      security:
        - rootKey: []
      summary: Update an Identity
      tags:
        - identities
      x-speakeasy-name-override: updateIdentity
  /permissions/create:
    post:
      description: |
        Creates a new permission for the RBAC system. Permissions can be assigned directly to keys or grouped into roles.
        Use hierarchical names like `documents.read` or `admin.users.delete`.

        **Note**: Permission names must be unique.

        **Permissions Needed**: Requires `rbac.*.create_permission`.
      operationId: createPermission
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsCreatePermissionRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsCreatePermissionResponseBody'
          description: Permission created successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "409":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictErrorResponse'
          description: Conflict - permission with that name already exists
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Create a Permission
      tags:
        - permissions
      x-speakeasy-name-override: CreatePermission
  /permissions/create:
    post:
      description: |
        Creates a new role to group related permissions. Roles simplify assigning consistent permissions to multiple keys.

        **Note**: Role names must be unique.

        **Permissions Needed**: Requires `rbac.*.create_role`.
      operationId: createRole
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsCreateRoleRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsCreateRoleResponseBody'
          description: Role created successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "409":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictErrorResponse'
          description: Conflict - A role with this name already exists
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Create a Role
      tags:
        - permissions
      x-speakeasy-name-override: CreateRole
  /permissions/delete:
    post:
      description: |
        Removes a permission from the workspace. This also removes the permission from all associated keys and roles.

        **Important**: This operation is irreversible and affects all keys/roles with this permission.

        **Permissions Needed**: Requires `rbac.*.delete_permission`.
      operationId: deletePermission
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsDeletePermissionRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsDeletePermissionResponseBody'
          description: Permission deleted successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found - The specified permission does not exist
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Delete a Permission
      tags:
        - permissions
      x-speakeasy-name-override: DeletePermission
  /permissions/delete:
    post:
      description: |
        Removes a role from the workspace. This also removes the role from all assigned keys.

        **Important**: This operation is irreversible and affects all keys assigned this role.

        **Permissions Needed**: Requires `rbac.*.delete_role`.
      operationId: deleteRole
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsDeleteRoleRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsDeleteRoleResponseBody'
          description: Role deleted successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Delete a Role
      tags:
        - permissions
      x-speakeasy-name-override: DeleteRole
  /permissions/get:
    post:
      description: |
        Retrieves details about a specific permission by its ID or slug.

        **Permissions Needed**: Requires `rbac.*.read_permission`.
      operationId: getPermission
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsGetPermissionRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsGetPermissionResponseBody'
          description: Permission retrieved successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Get a Permission
      tags:
        - permissions
      x-speakeasy-name-override: GetPermission
  /permissions/get:
    post:
      description: |
        Retrieves details about a specific role (by ID or name), including its assigned permissions.

        **Permissions Needed**: Requires `rbac.*.read_role`.
      operationId: getRole
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsGetRoleRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsGetRoleResponseBody'
          description: Role retrieved successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: Get a Role
      tags:
        - permissions
      x-speakeasy-name-override: GetRole
  /permissions/list:
    post:
      description: |
        Retrieves all permissions in the workspace. Results are paginated.

        **Permissions Needed**: Requires `rbac.*.read_permission`.
      operationId: listPermissions
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsListPermissionsRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsListPermissionsResponseBody'
          description: Permissions retrieved successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: List Permissions
      tags:
        - permissions
      x-speakeasy-name-override: ListPermissions
  /permissions/list:
    post:
      description: |
        Retrieves all roles in the workspace, including their assigned permissions. Results are paginated.

        **Permissions Needed**: Requires `rbac.*.read_role`.
      operationId: listRoles
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/V2PermissionsListRolesRequestBody'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/V2PermissionsListRolesResponseBody'
          description: Roles retrieved successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestErrorResponse'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenErrorResponse'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'
          description: Internal Server Error
      security:
        - rootKey: []
      summary: List Roles
      tags:
        - permissions
      x-speakeasy-name-override: ListRoles
security:
  - rootKey: []
servers:
  - url: https://api.example.com/
tags:
  - description: API management operations
    name: apis
  - description: Identity management operations
    name: identities
  - description: Permission and role management operations
    name: permissions
x-speakeasy-retries:
  backoff:
    exponent: 1.5
    initialInterval: 50
    maxElapsedTime: 10000
    maxInterval: 1000
  retryConnectionErrors: true
  statusCodes:
    - 5XX
  strategy: backoff